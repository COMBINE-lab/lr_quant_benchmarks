[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.13130623.svg)](https://doi.org/10.5281/zenodo.13130623)

# A replicable and modular benchmark for long-read RNA quantification methods

Pre-computed results appear below.

### TranSigner-protocol simulations

#### cDNA

|                           |   MARD |   Pearson ($\log_{1p}$) |   Kendall-$\tau$ |   Spearman $\rho$ |   CCC |   CCC_non_log |   NRMSE |   NRMSE_std |
|:--------------------------|-------:|------------------------:|-----------------:|------------------:|------:|--------------:|--------:|------------:|
| count_oarfish 0.5 (cov)   |  0.065 |                   0.951 |            0.85  |             0.869 | 0.95  |         0.997 |   1.865 |       0.075 |
| count_oarfish 0.5 (nocov) |  0.087 |                   0.962 |            0.816 |             0.839 | 0.961 |         0.986 |   4.178 |       0.167 |
| count_oarfish 0.4 (cov)   |  0.136 |                   0.867 |            0.707 |             0.739 | 0.865 |         0.992 |   3.204 |       0.128 |
| count_oarfish 0.4 (nocov) |  0.092 |                   0.954 |            0.805 |             0.829 | 0.953 |         0.982 |   4.703 |       0.188 |
| count_nanocount           |  0.327 |                   0.704 |            0.479 |             0.529 | 0.591 |         0.317 |  21.549 |       0.862 |
| count_nanocount (nofilt)  |  0.435 |                   0.889 |            0.561 |             0.632 | 0.885 |         0.963 |   6.731 |       0.269 |
| count_bambu               |  0.118 |                   0.903 |            0.755 |             0.786 | 0.903 |         0.948 |   7.867 |       0.315 |
| count_kallisto            |  0.197 |                   0.871 |            0.612 |             0.649 | 0.864 |         0.819 |  12.246 |       0.49  |

#### dRNA 

|                           |   MARD |   Pearson ($\log_{1p}$) |   Kendall-$\tau$ |   Spearman $\rho$ |   CCC |   CCC_non_log |   NRMSE |   NRMSE_std |
|:--------------------------|-------:|------------------------:|-----------------:|------------------:|------:|--------------:|--------:|------------:|
| count_oarfish 0.5 (cov)   |  0.042 |                   0.974 |            0.894 |             0.907 | 0.974 |         0.998 |   1.335 |       0.06  |
| count_oarfish 0.5 (nocov) |  0.06  |                   0.978 |            0.855 |             0.871 | 0.978 |         0.991 |   3.034 |       0.135 |
| count_oarfish 0.4 (cov)   |  0.101 |                   0.903 |            0.744 |             0.767 | 0.901 |         0.992 |   2.732 |       0.122 |
| count_oarfish 0.4 (nocov) |  0.067 |                   0.973 |            0.839 |             0.857 | 0.973 |         0.989 |   3.337 |       0.149 |
| count_nanocount           |  0.35  |                   0.726 |            0.47  |             0.521 | 0.671 |         0.549 |  16.776 |       0.748 |
| count_nanocount (nofilt)  |  0.443 |                   0.842 |            0.52  |             0.587 | 0.833 |         0.955 |   6.572 |       0.293 |
| count_bambu               |  0.094 |                   0.912 |            0.777 |             0.802 | 0.912 |         0.941 |   7.535 |       0.336 |
| count_kallisto            |  0.176 |                   0.873 |            0.614 |             0.646 | 0.869 |         0.769 |  12.152 |       0.542 |


### IsoQuant-protocol simulations

#### ONT

|                           |   MARD |   Pearson ($\log_{1p}$) |   Kendall-$\tau$ |   Spearman $\rho$ |   CCC |   CCC_non_log |   NRMSE |   NRMSE_std |
|:--------------------------|-------:|------------------------:|-----------------:|------------------:|------:|--------------:|--------:|------------:|
| count_oarfish 0.5 (cov)   |  0.062 |                   0.96  |            0.926 |             0.953 | 0.96  |         0.971 |   2.146 |       0.243 |
| count_oarfish 0.5 (nocov) |  0.061 |                   0.962 |            0.932 |             0.959 | 0.961 |         0.973 |   2.109 |       0.239 |
| count_oarfish 0.4 (cov)   |  0.086 |                   0.96  |            0.884 |             0.912 | 0.96  |         0.968 |   2.26  |       0.256 |
| count_oarfish 0.4 (nocov) |  0.061 |                   0.959 |            0.928 |             0.955 | 0.958 |         0.973 |   2.12  |       0.24  |
| count_nanocount           |  0.27  |                   0.902 |            0.731 |             0.789 | 0.897 |         0.773 |   4.798 |       0.543 |
| count_nanocount (nofilt)  |  0.298 |                   0.943 |            0.727 |             0.798 | 0.943 |         0.929 |   3.306 |       0.374 |
| count_bambu               |  0.09  |                   0.936 |            0.883 |             0.919 | 0.936 |         0.89  |   3.971 |       0.449 |
| count_kallisto            |  0.094 |                   0.953 |            0.885 |             0.92  | 0.953 |         0.972 |   2.09  |       0.236 |


#### PacBio

|                           |   MARD |   Pearson ($\log_{1p}$) |   Kendall-$\tau$ |   Spearman $\rho$ |   CCC |   CCC_non_log |   NRMSE |   NRMSE_std |
|:--------------------------|-------:|------------------------:|-----------------:|------------------:|------:|--------------:|--------:|------------:|
| count_oarfish 0.5 (cov)   |  0.013 |                   0.986 |            0.975 |             0.98  | 0.986 |         0.994 |   0.984 |       0.107 |
| count_oarfish 0.5 (nocov) |  0.015 |                   0.984 |            0.971 |             0.977 | 0.984 |         0.993 |   1.13  |       0.123 |
| count_oarfish 0.4 (cov)   |  0.015 |                   0.986 |            0.973 |             0.979 | 0.985 |         0.994 |   0.978 |       0.106 |
| count_oarfish 0.4 (nocov) |  0.018 |                   0.98  |            0.966 |             0.973 | 0.98  |         0.99  |   1.314 |       0.143 |
| count_nanocount           |  0.054 |                   0.957 |            0.936 |             0.963 | 0.957 |         0.933 |   3.307 |       0.36  |
| count_nanocount (nofilt)  |  0.075 |                   0.934 |            0.921 |             0.957 | 0.934 |         0.925 |   3.507 |       0.382 |
| count_bambu               |  0.019 |                   0.983 |            0.969 |             0.977 | 0.983 |         0.928 |   3.262 |       0.355 |
| count_kallisto            |  0.031 |                   0.99  |            0.965 |             0.977 | 0.989 |         0.935 |   3.169 |       0.345 |


This benchmark was developed using the following tools and versions:

| Tool | version |
| -------- | ------- |
| bambu     | 3.4.1  |
| bustools  | 0.43.2 |
| kallisto  | 0.51.0 |
| NanoCount | 1.1.0  |
| oarfish   | 0.4.0 & 0.5.0 |
| Python    | 3.12.3 |
| R         | 4.3.3  |
| Snakemake | 8.16.0 |
